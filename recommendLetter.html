<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <style>
    body {
      background: #918483;
    }
    
    p {
      text-indent: 20px;
    }

    #paper {
      padding: 5%;
      border: solid black .1mm;
      margin: 30mm 70mm;
      background: white;
    }
  </style>
  <title>Letter of Recommendation</title>
</head>
<body>
  <div id="paper">
    <p id="dateEntry"></p>
    <p class="recipientNameEntry"></p>
    <p id="recipientTitleEntry"></p>
    <p class="companyNameEntry"></p>
    <p id="companyAddressEntry"></p>
    <p><span id="companyCityEntry"></span> <span id="companyStateEntry"></span>, <span id="companyZipEntry"></span></p>
    <br>

    <p>Dear <span class="recipientNameEntry"></span>,</p>
    

    <p>I am pleased to recommend <span id="applicantFullNameEntry"></span> for the position of <span id="applicantPositionEntry"></span> at <span class="companyNameEntry"></span>. I got to know <span class="applicantNameEntry"></span> as <span class="hisHerEntry"></span> professor at <span class="collegeEntry"></span>. During this time with <span class="himHerEntry"></span>, I was greatly impressed by <span class="applicantNameEntry"></span>'s dedication to <span id="studyFieldEntry"></span>.</p>
    

    <p>While studying in <span id="courseNamesEntry"></span> <span class="applicantNameEntry"></span> demonstrated an exceptional work ethic. <span id="workExampleEntry"></span> <span class="applicantNameEntry"></span>'s consistent effort as one of my students has been thoroughly impressive.</p>
    

    <p>In addition to <span class="applicantNameEntry"></span>'s exceptional work as one of my students, <span class="hisHerEntry"></span> personality made <span class="himHerEntry"></span> a great member of the <span class="collegeEntry"></span> community. <span id="personalityExampleEntry"></span></p>
    

    <span id="warningEntry"></span>

    <p>It is my honor to recommend <span class="applicantNameEntry"></span> for this position. I am confident that <span id="heSheEntry"></span> will make a strong and hard-working addition to your team. You are more than welcome to contact me with any questions regarding <span class="applicantNameEntry"></span>'s candidacy for this job.</p>

    <p>Sincerely,</p>

    <p>___________________</p>
    <p><span id="writerNameEntry"></span></p>
    <p><span id="writerPhoneEntry"></span></p>
    <p><span id="writerEmailEntry"></span></p>
  </div>

  <script>
    let queryObj = new URLSearchParams(location.search);
    let queryString = queryObj.toString().replace(/\+/g, ' ');
    let queryValues = queryString.split('&');
  
    populateEntry('recipientTitleEntry', 'recipientTitle');
    populateEntry('companyAddressEntry', 'companyAddress');
    populateEntry('companyCityEntry', 'companyCity');
    populateEntry('companyStateEntry', 'companyState');
    populateEntry('companyZipEntry', 'companyZip');
    populateEntry('applicantPositionEntry', 'applicantPosition');
    populateEntry('studyFieldEntry', 'applicantStudy');
    populateEntry('writerPhoneEntry', 'writerPhone');
    populateEntry('writerEmailEntry', 'writerEmail');
    populateEntry('recipientNameEntry', 'recipientName');
    populateEntry('companyNameEntry', 'companyName');
    populateEntry('applicantNameEntry', 'applicantFirstName');
    populateEntry('collegeEntry', 'writerUniversity');
    populateEntry('workExampleEntry', 'workExample');
    populateEntry('personalityExampleEntry', 'personalityExample');
    populateEntry('writerNameEntry', 'writerFirstName', true, 'writerLastName');
    populateEntry('applicantFullNameEntry', 'applicantFirstName', true, 'applicantLastName');
    populateEntry('hisHerEntry', 'gender', false, undefined, 'his', 'her');
    populateEntry('himHerEntry', 'gender', false, undefined, 'him', 'her');
    populateEntry('heSheEntry', 'gender', false, undefined, 'he', 'she');
    populateListEntry('courseNamesEntry', 'courseName');
  
    let months = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    let currentDate = new Date();
    document.getElementById('dateEntry').innerHTML = `${months[currentDate.getMonth()]} ${currentDate.getDate()}, ${currentDate.getFullYear()}`;
  
  
    if(queryObj.get('warning') != '') {
      document.getElementById('warningEntry').innerHTML = `<p>Now, there is something you should know about ${queryObj.get("applicantFirstName")}. ${queryObj.get('warning')}</p>`;
    }
  
    function populateEntry(entryName, queryValue, isTwoWords, secondQueryValue, maleRef, femaleRef) {
      if(isTwoWords) {
        document.getElementById(entryName).innerHTML = queryObj.get(queryValue) + ' ' + queryObj.get(secondQueryValue);
      }/*if isTwoWords*/
      else {
        if(document.getElementsByClassName(entryName).length != 0) {
          if(maleRef != undefined) {
            for(entry of document.getElementsByClassName(entryName)) {
              entry.innerHTML = (queryObj.get('gender') == 'male') ? maleRef : femaleRef;
            }/*For loop*/
          }/*If invloves gender*/
          else {
            for(entry of document.getElementsByClassName(entryName)) {
              entry.innerHTML = queryObj.get(queryValue);
            }/*For loop*/
          }/*If doesn't invlove gender*/
        }/*If is a class*/
        else {
          if(maleRef != undefined) {
            document.getElementById(entryName).innerHTML = (queryObj.get('gender') == 'male') ? maleRef : femaleRef;
          }/*If doesn't involve gender*/
          else {
            document.getElementById(entryName).innerHTML = queryObj.get(queryValue);
          }/*Else if not invloving gender*/
        }/*Else if not a class*/
      }/*Else if !isTwoWords*/
    }/*Function end*/
  
    function populateListEntry(entryName, queryIdentifier) {
      let querySubValues = [];
      for(queryValue of queryValues) {
        if(queryValue.includes(queryIdentifier)) {
          querySubValues.push(queryValue);
        }/*If statement*/
      }/*For loop*/
      if(querySubValues.length == 1) {
        document.getElementById(entryName).innerHTML = `${querySubValues[0].substr(queryValue.indexOf('=') + 5)}, `;
      }/*If only 1 list entry*/
      else {
        for(let i = 0; i < querySubValues.length - 1; i++) {
        document.getElementById(entryName).innerHTML += `${querySubValues[i].substr(queryValue.indexOf('=') + 5)}, `;
        }/*For loop*/
        document.getElementById(entryName).innerHTML += ` and ${querySubValues[querySubValues.length - 1].substr(queryValue.indexOf('=') + 5)},`;
      }/*If more than 1 list entry*/
    }/*Function end*/
  </script>
</body>
</html>